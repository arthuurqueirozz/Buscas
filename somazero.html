<!DOCTYPE html>
<html>
<head>
  <title>Soma Zero</title>
</head>
<body>
  <h1>Soma Zero</h1>
  <p>Escolha o número inicial de itens na pilha: <input type="number" id="initialItems" value="10"></p>
  <p>Quem joga primeiro: <input type="radio" id="playerFirst" name="player" value="player"> Jogador <input type="radio" id="computerFirst" name="player" value="computer"> Computador</p>
  <div id="game"></div>

  <script>
    const gameDiv = document.getElementById('game');
    const initialItemsInput = document.getElementById('initialItems');
    const playerFirstRadio = document.getElementById('playerFirst');
    const computerFirstRadio = document.getElementById('computerFirst');

    let currentPlayer;
    let itemsInPile;

    playerFirstRadio.addEventListener('change', () => {
      currentPlayer = 'player';
      itemsInPile = parseInt(initialItemsInput.value);
      renderGameState();
    });

    computerFirstRadio.addEventListener('change', () => {
      currentPlayer = 'computer';
      itemsInPile = parseInt(initialItemsInput.value);
      computerMove();
    });

    function renderGameState() {
      gameDiv.innerHTML = `
        <p>Itens na pilha: ${itemsInPile}</p>
        <p>É a vez do ${currentPlayer === 'player' ? 'jogador' : 'computador'}.</p>
        <button onclick="removeItems(1)">Remover 1 item</button>
        <button onclick="removeItems(2)">Remover 2 itens</button>
        <button onclick="removeItems(3)">Remover 3 itens</button>
      `;
    }

    function removeItems(count) {
      if (currentPlayer === 'player') {
        if (count < 1 || count > 3 || count > itemsInPile) {
          alert('Escolha um número válido de itens para remover (1, 2 ou 3).');
          return;
        }
        itemsInPile -= count;
        currentPlayer = 'computer';
        renderGameState();

        if (itemsInPile === 0) {
          gameDiv.innerHTML = '<p>O jogador venceu!</p>';
        } else {
          computerMove();
        }
      }
    }

    function computerMove() {
      const bestMove = findBestMove(itemsInPile);
      itemsInPile -= bestMove;
      currentPlayer = 'player';
      renderGameState();

      if (itemsInPile === 0) {
        gameDiv.innerHTML = '<p>O computador venceu!</p>';
      }
    }

    function findBestMove(items) {
      // Implementação do algoritmo Minimax para determinar a melhor jogada do computador
      const maxDepth = 3; // Profundidade máxima da árvore de busca

      function minimax(currentItems, depth, maximizingPlayer) {
        if (depth === 0 || currentItems === 0) {
          return 0; // Valor da folha
        }

        if (maximizingPlayer) {
          let maxEval = -Infinity;
          for (let i = 1; i <= 3; i++) {
            if (i <= currentItems) {
              const eval = minimax(currentItems - i, depth - 1, false);
              maxEval = Math.max(maxEval, eval);
            }
          }
          return maxEval;
        } else {
          let minEval = Infinity;
          for (let i = 1; i <= 3; i++) {
            if (i <= currentItems) {
              const eval = minimax(currentItems - i, depth - 1, true);
              minEval = Math.min(minEval, eval);
            }
          }
          return minEval;
        }
      }

      let bestValue = -Infinity;
      let bestMove = -1;

      for (let i = 1; i <= 3; i++) {
        if (i <= items) {
          const currentValue = minimax(items - i, maxDepth, false);
          if (currentValue > bestValue) {
            bestValue = currentValue;
            bestMove = i;
          }
        }
      }

      return bestMove;
    }
  </script>
</body>
</html>
